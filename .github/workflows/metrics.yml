name: ğŸš€ GitHub Metrics Generator

on:
  # Schedule daily updates at 2 AM UTC
  schedule: [{cron: "0 2 * * *"}]
  # Run workflow manually
  workflow_dispatch:
  # Run workflow when pushing to main
  push: {branches: ["main"]}

jobs:
  github-metrics:
    runs-on: [self-hosted, linux, x64]
    permissions:
      contents: write
    steps:
      - name: ğŸ“Š Generate GitHub Metrics
        uses: lowlighter/metrics@latest
        with:
          # ğŸ”‘ Authentication
          token: ${{ secrets.METRICS_TOKEN }}
          
          # ğŸ¨ Template & Display
          template: classic
          
          # ğŸ“ Base Content - Main Stats
          base: header, activity, community, repositories, metadata
          
          # ğŸ§® Traffic Stats
          plugin_traffic: true
          
          # â° WakaTime Stats
          plugin_wakatime: true
          plugin_wakatime_token: ${{ secrets.WAKATIME_TOKEN }}
          plugin_wakatime_sections: time,projects,languages,editors
          plugin_wakatime_days: 30
          plugin_wakatime_limit: 5
          
          # âš™ï¸ Configuration
          config_timezone: America/New_York
          
          # ğŸ“¤ Output
          filename: github-metrics.svg
          output_action: commit
          output_condition: data-changed
          committer_message: "ğŸš€ Auto-generated metrics for run #${{ github.run_number }}"